markdown
# Polymer Topology Analysis with LAMMPS

This project uses Molecular Dynamics (MD) simulations via LAMMPS to analyze and compare the conformational properties (specifically the Radius of Gyration, $R_g$) of two different polymer topologies:

1.  **Alpha Polymer:** A 3D, tetracyclic (knotted) polymer structure.
2.  **Tree Polymer:** A 2D, highly branched dendrimer-like structure.

The primary workflow is automated by a `bash` script, which runs two separate LAMMPS simulations and then calls a Python script to perform a comparative analysis, calculating the final ratio of their mean-square radii of gyration ($\langle R_g^2 \rangle_{\text{alpha}} / \langle R_g^2 \rangle_{\text{tree}}$).

The framework is also designed to be adaptable for calculating the standard **$g$-factor** by comparing a branched polymer to a linear chain of the same mass.

## Project Structure



.
├── documentation/
│   ├── mathematical\_derivation.tex
│   └── derivation (5).pdf
├── lammps\_files/
│   ├── alpha\_polymer.data      \# Input geometry for the alpha polymer
│   ├── tree\_polymer.data       \# Input geometry for the tree polymer
│   │
│   ├── alpha\_polymer.in        \# LAMMPS physics/simulation script for alpha
│   ├── tree\_polymer.in         \# LAMMPS physics/simulation script for tree
│   │
│   ├── run\_simulation.sh       \# Main executable: SLURM batch script
│   └── compute\_gyration.py     \# Python analysis script
│
├── results/
│   └── (This folder is for storing simulation outputs)
│
└── README.md                   \# This file

`

## Dependencies

* [LAMMPS](https://www.lammps.org/) (Molecular Dynamics Simulator)
* [OpenMPI](https://www.open-mpi.org/) (or any MPI implementation compatible with your LAMMPS build)
* `Python 3`
    * `numpy`
    * `matplotlib`
* A SLURM workload manager (the `run_simulation.sh` is written as a `sbatch` script)

## How to Run

All core files are located in the `lammps_files/` directory.

### Step 1: Prepare Input Files (If Needed)

This project already contains `alpha_polymer.data` and `tree_polymer.data`. If you need to regenerate them (e.g., with a different number of atoms), you must use the original Python generator scripts:

* `alpha_polymer.data` is generated by `alpha_graph_3D_alpha_like_...py`
* `tree_polymer.data` is generated by `generate_from_coords_2D.py`

### Step 2: Run the Simulation and Analysis

The `run_simulation.sh` script automates the entire process. It runs both simulations and then calls the Python analysis script.

bash
# Navigate to the main directory
cd lammps_files/

# Submit the job to the SLURM scheduler
sbatch run_simulation.sh
`

### Step 3: Check the Results

After the job is complete, the `lammps_files/` directory will contain the new results:

  * **`gyration.alpha_polymer.txt`**: The raw $R_g$ vs. time data for the alpha polymer.
  * **`gyration.tree_polymer.txt`**: The raw $R_g$ vs. time data for the tree polymer.
  * **`g_factor_analysis_results.png`**: A 2x2 plot showing the $R_g$ time series and distribution for *both* simulations.
  * **`g_factor_results.txt`**: The final summary file containing the calculated $\langle R_g^2 \rangle$ values and their final ratio.

## Key File Descriptions

### `run_simulation.sh`

This is the main executable. It is a `bash` script for a SLURM cluster that:

1.  Defines the two data files to simulate (`alpha_polymer.data`, `tree_polymer.data`).
2.  Loops through each file.
3.  Calls `mpirun lmp` for each polymer, passing the correct `.data` and `.in` files as variables.
4.  After *all* simulations are finished, it calls `python3 compute_gyration.py`, passing it the two new `gyration.*.txt` output files for the final analysis.

### `alpha_polymer.in` & `tree_polymer.in`

These are LAMMPS input "template" scripts. They define the physics of the simulation:

  * **Units:** `real`
  * **Potentials:** `lj/cut` (Lennard-Jones) and `fene` bonds.
  * **Minimization:** A multi-stage minimization procedure to safely relax the initial structures.
  * **Simulation:** An NVT (Langevin) simulation to run production dynamics at 300K.
  * **Output:** They compute the radius of gyration (`compute myRg`) and save it to a file.

### `compute_gyration.py`

This is the final analysis script. It is called by `run_simulation.sh` and does not need to be run manually.

1.  It accepts two filenames as command-line arguments (e.g., `gyration.alpha_polymer.txt` and `gyration.tree_polymer.txt`).
2.  It loads the data for both, ignoring the first 75% as equilibration.
3.  It calculates the average **mean-square radius of gyration** ($\langle R_g^2 \rangle$) for both polymers.
4.  It computes the final desired ratio: $\langle R_g^2 \rangle_{\text{alpha}} / \langle R_g^2 \rangle_{\text{tree}}$.
5.  It saves the plot and a text file with the results.

<!-- end list -->


```
